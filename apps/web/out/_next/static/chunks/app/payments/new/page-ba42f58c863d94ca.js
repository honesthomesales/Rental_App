(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[204],{6094:function(e,t,a){Promise.resolve().then(a.bind(a,1073))},1073:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var s=a(7573),n=a(7653),l=a(1695),r=a(3351),i=a(8113),c=a(8204),o=a(6286),d=a(8177),m=a(269),u=a(6991),p=a(2548);let x=c.Ry({transaction_type:c.Km(["rent_payment","loan_payment","property_sale","property_purchase","expense","income"]),amount:c.Rx().positive("Amount must be positive"),description:c.Z_().min(1,"Description is required"),transaction_date:c.Z_().min(1,"Transaction date is required"),payment_status:c.Km(["pending","completed","failed","cancelled"]).default("completed"),property_id:c.Z_().optional(),tenant_id:c.Z_().optional(),loan_id:c.Z_().optional(),bank_account_id:c.Z_().optional(),reference_number:c.Z_().optional(),notes:c.Z_().optional()});function b(e){let{transaction:t,onSuccess:a,onCancel:l}=e,[c,b]=(0,n.useState)(!1),[h,y]=(0,n.useState)([]),[_,f]=(0,n.useState)([]),[j,v]=(0,n.useState)([]),{register:N,handleSubmit:g,watch:k,formState:{errors:P},reset:S}=(0,r.cI)({resolver:(0,i.F)(x),defaultValues:t?{transaction_type:t.transaction_type,amount:t.amount,description:t.description||"",transaction_date:t.transaction_date,payment_status:t.payment_status,property_id:t.property_id||"",tenant_id:t.tenant_id||"",loan_id:t.loan_id||"",bank_account_id:t.bank_account_id||"",reference_number:t.reference_number||"",notes:t.notes||""}:{transaction_type:"rent_payment",payment_status:"completed",transaction_date:new Date().toISOString().split("T")[0]}}),Z=k("property_id");k("transaction_type"),(0,n.useEffect)(()=>{w()},[]),(0,n.useEffect)(()=>{Z?v(_.filter(e=>e.property_id===Z)):v(_)},[Z,_]);let w=async()=>{try{let[e,t]=await Promise.all([o.PropertiesService.getAll(),o.TenantsService.getAll()]);e.success&&e.data&&y(e.data),t.success&&t.data&&(f(t.data),v(t.data))}catch(e){p.ZP.error("Error loading data")}},T=async e=>{try{if(b(!0),t){let s={id:t.id,...e},n=await o.TransactionsService.update(t.id,s);n.success&&n.data?(p.ZP.success("Transaction updated successfully"),null==a||a(n.data)):p.ZP.error(n.error||"Failed to update transaction")}else{let t=await o.TransactionsService.create(e);t.success&&t.data?(p.ZP.success("Transaction created successfully"),S(),null==a||a(t.data)):p.ZP.error(t.error||"Failed to create transaction")}}catch(e){p.ZP.error("An error occurred")}finally{b(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(d.Z,{className:"w-6 h-6 text-primary-600 mr-3"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Edit Transaction":"Add New Transaction"})]}),(0,s.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(m.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("form",{onSubmit:g(T),className:"p-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Transaction Details"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Type *"}),(0,s.jsx)("select",{...N("transaction_type"),className:"input",children:[{value:"rent_payment",label:"Rent Payment"},{value:"loan_payment",label:"Loan Payment"},{value:"expense",label:"Expense"},{value:"income",label:"Income"},{value:"property_sale",label:"Property Sale"},{value:"property_purchase",label:"Property Purchase"}].map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),P.transaction_type&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:P.transaction_type.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),(0,s.jsx)("input",{...N("amount",{valueAsNumber:!0}),type:"number",step:"0.01",className:"input",placeholder:"0.00"}),P.amount&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:P.amount.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Date *"}),(0,s.jsx)("input",{...N("transaction_date"),type:"date",className:"input"}),P.transaction_date&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:P.transaction_date.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Status *"}),(0,s.jsx)("select",{...N("payment_status"),className:"input",children:[{value:"completed",label:"Completed"},{value:"pending",label:"Pending"},{value:"failed",label:"Failed"},{value:"cancelled",label:"Cancelled"}].map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),P.payment_status&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:P.payment_status.message})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,s.jsx)("input",{...N("description"),className:"input",placeholder:"Enter transaction description"}),P.description&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:P.description.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reference Number"}),(0,s.jsx)("input",{...N("reference_number"),className:"input",placeholder:"e.g., Check #1234"})]}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 mt-6",children:"Related Information"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property"}),(0,s.jsxs)("select",{...N("property_id"),className:"input",children:[(0,s.jsx)("option",{value:"",children:"Select Property (Optional)"}),h.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," - ",e.address]},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tenant"}),(0,s.jsxs)("select",{...N("tenant_id"),className:"input",children:[(0,s.jsx)("option",{value:"",children:"Select Tenant (Optional)"}),j.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name]},e.id))]})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),(0,s.jsx)("textarea",{...N("notes"),rows:3,className:"input",placeholder:"Additional notes about this transaction"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 mt-8 pt-6 border-t border-gray-200",children:[(0,s.jsx)("button",{type:"button",onClick:l,className:"btn btn-secondary",children:"Cancel"}),(0,s.jsxs)("button",{type:"submit",disabled:c,className:"btn btn-primary",children:[c?(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):(0,s.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),t?"Update Transaction":"Create Transaction"]})]})]})]})})}function h(){let e=(0,l.useRouter)(),[t,a]=(0,n.useState)(!0);return t?(0,s.jsx)(b,{onSuccess:t=>{p.ZP.success("Transaction created successfully!"),e.push("/payments")},onCancel:()=>{e.push("/payments")}}):null}},8177:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(4313).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},1695:function(e,t,a){"use strict";var s=a(1219);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[334,134,918,286,293,528,744],function(){return e(e.s=6094)}),_N_E=e.O()}]);