(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[993],{3244:function(e,t,s){Promise.resolve().then(s.bind(s,9476))},9476:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var a=s(7573),n=s(7653),r=s(9569),l=s(7252),c=s(4848),i=s(9435),d=s(1387),o=s(3727),m=s(8410),x=s(2966),u=s(5025),h=s(8177),y=s(7419),p=s(3172),g=s(5265),b=s(997),j=s(6286),f=s(9369),N=s(2548);function v(){let[e,t]=(0,n.useState)({potentialIncome:0,expectedIncome:0,collectedIncome:0,insurance:0,taxes:0,totalPayments:0,repairs:0,miscIncome:0,otherExpenses:0,expectedProfit:0,netProfit:0,expectedRentIncome:0,collectedRentIncome:0}),[s,v]=(0,n.useState)(()=>{let e=new Date,t=(0,r.Z)(e),s=(0,l.Z)(e);return{start:(0,c.Z)(t,"yyyy-MM-dd"),end:(0,c.Z)(s,"yyyy-MM-dd")}}),w=async()=>{if(!j.supabase)return console.error("Supabase client not available"),null;try{let{data:e,error:t}=await j.supabase.from("RENT_payments").select("payment_date").order("payment_date",{ascending:!1}).limit(1);if(t)return console.error("Error fetching most recent payment date:",t),null;if(e&&e.length>0){let t=e[0],s=new Date(t.payment_date);return{year:s.getFullYear(),month:s.getMonth()}}}catch(e){console.error("Error finding most recent month with data:",e)}let e=new Date;return{year:e.getFullYear(),month:e.getMonth()}},_=e=>{try{let t;let a=new Date(s.start+"T00:00:00");t="prev"===e?(0,i.Z)(a,1):(0,d.Z)(a,1);let n=(0,r.Z)(t),o=(0,l.Z)(t),m={start:(0,c.Z)(n,"yyyy-MM-dd"),end:(0,c.Z)(o,"yyyy-MM-dd")};v(m)}catch(e){}},[k,M]=(0,n.useState)([]),[D,L]=(0,n.useState)([]),[S,P]=(0,n.useState)(!0),[Z,C]=(0,n.useState)(!0),[E,T]=(0,n.useState)(!1),[I,R]=(0,n.useState)(!1),[F,$]=(0,n.useState)(null),[A,O]=(0,n.useState)([]),[Y,G]=(0,n.useState)(0),[U,q]=(0,n.useState)(0),[z,W]=(0,n.useState)({type:"expense",amount:0,description:"",date:(0,c.Z)(new Date,"yyyy-MM-dd")});(0,n.useEffect)(()=>{B()},[s]);let B=async()=>{if(!j.supabase){N.ZP.error("Supabase client not available");return}try{P(!0);let{data:e,error:a}=await j.supabase.from("RENT_properties").select("*");if(a){N.ZP.error("Failed to load properties");return}let{data:n,error:i}=await j.supabase.from("RENT_tenants").select("*");if(i){N.ZP.error("Failed to load tenants");return}let{data:d,error:o}=await j.supabase.from("RENT_payments").select("*").gte("payment_date",s.start).lte("payment_date",s.end);if(o){N.ZP.error("Failed to load payments");return}if(d&&0===d.length&&Z){let e=await w(),t=new Date(s.start).getMonth(),a=new Date(s.start).getFullYear();if(e&&(e.month!==t||e.year!==a)){let t=(0,r.Z)(new Date(e.year,e.month,1)),s=(0,l.Z)(new Date(e.year,e.month,1)),a={start:(0,c.Z)(t,"yyyy-MM-dd"),end:(0,c.Z)(s,"yyyy-MM-dd")};v(a);return}}let m=new Date(s.start),x=new Date(s.end),u=(x.getFullYear()-m.getFullYear())*12+(x.getMonth()-m.getMonth())+1,h=e.reduce((e,t)=>{let s=(0,f.S6)(t.notes),a=(0,f.GN)(t.monthly_rent||0,s);return e+a},0);O(e),M([]),L(d||[]),G(h),q(u);let y=new Set(n.map(e=>e.property_id)),p=e.filter(e=>y.has(e.id)).reduce((e,t)=>{let s=(0,f.S6)(t.notes),a=(0,f.GN)(t.monthly_rent||0,s);return e+a},0),g=d.reduce((e,t)=>{let s=Math.max(0,t.amount||0);return e+s},0),b=d.filter(e=>{var t;let s=(null===(t=e.payment_type)||void 0===t?void 0:t.toLowerCase())||"";return"rent"===s}).reduce((e,t)=>{let s=Math.max(0,t.amount||0);return e+s},0),_=d.reduce((e,t)=>e+(t.amount||0),0),k=e.reduce((e,t)=>e+(t.insurance_premium||0),0),D=e.reduce((e,t)=>e+(t.property_tax||0),0),S=e.reduce((e,t)=>e+(t.purchase_payment||0),0),C=d.filter(e=>{var t;let s=(null===(t=e.payment_type)||void 0===t?void 0:t.toLowerCase())||"";return"repairs"===s}).reduce((e,t)=>{let s=Math.abs(t.amount||0);return e+s},0),E=d.filter(e=>{var t;let s=(null===(t=e.payment_type)||void 0===t?void 0:t.toLowerCase())||"";return 0>(e.amount||0)&&"repairs"!==s}).reduce((e,t)=>{let s=Math.abs(t.amount||0);return e+s},0),T=d.filter(e=>{var t;let s=(null===(t=e.payment_type)||void 0===t?void 0:t.toLowerCase())||"";return(e.amount||0)>0&&"rent"!==s}).reduce((e,t)=>e+(t.amount||0),0),I=k+D+S+C+E,R=p-I;t({potentialIncome:h,expectedIncome:p,collectedIncome:g,insurance:k,taxes:D,totalPayments:S,repairs:C,miscIncome:T,otherExpenses:E,expectedProfit:R,netProfit:_-(k+D+S)+T,expectedRentIncome:p,collectedRentIncome:b})}catch(e){N.ZP.error("Error loading profit data")}finally{P(!1),C(!1)}},H=async()=>{if(!j.supabase){N.ZP.error("Supabase client not available");return}if(z.amount<=0||!z.description.trim()){N.ZP.error("Please enter a valid amount and description");return}N.ZP.success("Entry added successfully"),W({type:"expense",amount:0,description:"",date:(0,c.Z)(new Date,"yyyy-MM-dd")}),T(!1),B()},J=async()=>{if(!j.supabase){N.ZP.error("Supabase client not available");return}if(!F||z.amount<=0||!z.description.trim()){N.ZP.error("Please enter a valid amount and description");return}N.ZP.success("Entry updated successfully"),W({type:"expense",amount:0,description:"",date:(0,c.Z)(new Date,"yyyy-MM-dd")}),$(null),R(!1),B()},K=e=>{switch(null==e?void 0:e.toLowerCase()){case"rent":return"bg-blue-100 text-blue-800";case"utilities":return"bg-purple-100 text-purple-800";case"late_fee":return"bg-red-100 text-red-800";case"deposit":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Q=e=>{switch(null==e?void 0:e.toLowerCase()){case"rent":return"Rent";case"utilities":return"Utilities";case"late_fee":return"Late Fee";case"deposit":return"Deposit";default:return e||"Other"}},V=e=>{(0,N.ZP)("Payment editing functionality will be implemented soon")},X=async e=>{(0,N.ZP)("Payment deletion functionality will be implemented soon")};return S?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Profit Analysis"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Track income, expenses, and profitability"})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Net Profit"}),(0,a.jsxs)("p",{className:"text-2xl font-bold ".concat(e.netProfit>=0?"text-green-600":"text-red-600"),children:["$",e.netProfit.toLocaleString()]})]})})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"card mb-6",children:(0,a.jsx)("div",{className:"card-content py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 text-primary-600"}),(0,a.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:(0,c.Z)(new Date(s.start+"T00:00:00"),"MMMM yyyy")})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>_("prev"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",type:"button",children:(0,a.jsx)(m.Z,{className:"w-5 h-5 text-gray-600"})}),(0,a.jsx)("button",{onClick:()=>_("next"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",type:"button",children:(0,a.jsx)(x.Z,{className:"w-5 h-5 text-gray-600"})})]})]})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 text-red-600 mr-2"}),(0,a.jsx)("h2",{className:"card-title",children:"Fixed Expenses"})]})}),(0,a.jsx)("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance"}),(0,a.jsxs)("div",{className:"p-3 bg-gray-100 rounded border text-gray-700",children:["$",e.insurance.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taxes"}),(0,a.jsxs)("div",{className:"p-3 bg-gray-100 rounded border text-gray-700",children:["$",e.taxes.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Payments"}),(0,a.jsxs)("div",{className:"p-3 bg-gray-100 rounded border text-gray-700",children:["$",e.totalPayments.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Fixed Expenses"}),(0,a.jsxs)("div",{className:"p-3 bg-red-50 rounded border text-red-700 font-bold",children:["$",(e.insurance+e.taxes+e.totalPayments).toLocaleString()]})]})]})})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 text-red-600 mr-2"}),(0,a.jsx)("h2",{className:"card-title",children:"1 Time Expense and Income"})]})}),(0,a.jsx)("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3 text-center",children:"Expenses"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Repairs"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-yellow-600",children:["$",e.repairs.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Other Expenses"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-gray-600",children:["$",e.otherExpenses.toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3 text-center",children:"Income"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Misc Income"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-green-600",children:["$",e.miscIncome.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Rent Collected"}),(0,a.jsxs)("p",{className:"text-xl font-bold ".concat(e.collectedRentIncome>=0?"text-green-600":"text-red-600"),children:["$",e.collectedRentIncome.toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200 space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Total Income:"}),(0,a.jsxs)("span",{className:"text-lg font-bold text-green-600",children:["$",(e.miscIncome+e.collectedRentIncome).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Total Debt:"}),(0,a.jsxs)("span",{className:"text-lg font-bold text-red-600",children:["$",(e.repairs+e.insurance+e.taxes+e.totalPayments+e.otherExpenses).toLocaleString()]})]})]})]})})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5 text-primary-600 mr-2"}),(0,a.jsx)("h2",{className:"card-title",children:"Rent Collection"})]})}),(0,a.jsxs)("div",{className:"card-content",children:[(0,a.jsx)("div",{className:"flex items-center justify-center h-48",children:(0,a.jsxs)("div",{className:"relative w-40 h-40",children:[(0,a.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 100 100",children:[(0,a.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#eab308",strokeWidth:"8"}),e.expectedRentIncome>0&&(0,a.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#10b981",strokeWidth:"8",strokeDasharray:"".concat(Math.min(e.collectedRentIncome/e.expectedRentIncome*251.2,251.2)," 251.2"),strokeDashoffset:"62.8",transform:"rotate(-90 50 50)",style:{strokeLinecap:"round"}})]}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Rent Collected"}),(0,a.jsxs)("p",{className:"text-sm font-bold",children:["$",e.collectedRentIncome.toLocaleString()]}),e.expectedRentIncome>0&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[Math.round(e.collectedRentIncome/e.expectedRentIncome*100),"%"]})]})})]})}),(0,a.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded mr-2"}),(0,a.jsx)("span",{className:"text-xs",children:"Rent Collected"})]}),(0,a.jsxs)("span",{className:"text-xs font-medium",children:["$",e.collectedRentIncome.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded mr-2"}),(0,a.jsx)("span",{className:"text-xs",children:"Expected"})]}),(0,a.jsxs)("span",{className:"text-xs font-medium",children:["$",e.expectedRentIncome.toLocaleString()]})]})]})]})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.Z,{className:"w-5 h-5 text-primary-600 mr-2"}),(0,a.jsx)("h2",{className:"card-title",children:"Payments List"})]}),(0,a.jsxs)("button",{onClick:()=>T(!0),className:"btn btn-primary btn-sm",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Add Entry"]})]})}),(0,a.jsx)("div",{className:"card-content",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Property"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Type"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Description"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Amount"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Actions"})]})}),(0,a.jsxs)("tbody",{children:[D.map(e=>{let t=A.find(t=>t.id===e.property_id);return(0,a.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-4 px-4 text-sm text-gray-900",children:(null==t?void 0:t.address)||"Unknown Property"}),(0,a.jsx)("td",{className:"py-4 px-4 text-sm text-gray-900",children:(0,c.Z)(new Date(e.payment_date),"MMM dd, yyyy")}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(K(e.payment_type)),children:Q(e.payment_type)})}),(0,a.jsx)("td",{className:"py-4 px-4 text-sm text-gray-900",children:e.notes||e.payment_type}),(0,a.jsxs)("td",{className:"py-4 px-4 font-medium ".concat(e.amount>=0?"text-green-600":"text-red-600"),children:["$",Math.abs(e.amount).toLocaleString()]}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>V(e),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:"Edit payment",children:(0,a.jsx)(g.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>X(e.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Remove payment",children:(0,a.jsx)(b.Z,{className:"w-4 h-4"})})]})})]},e.id)}),0===D.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"py-8 text-center text-gray-500",children:"No payments found for this date range."})})]})]})})})]})]}),E&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Add Entry"}),(0,a.jsx)("button",{onClick:()=>T(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,a.jsxs)("select",{value:z.type,onChange:e=>W({...z,type:e.target.value}),className:"input",children:[(0,a.jsx)("option",{value:"expense",children:"Expense"}),(0,a.jsx)("option",{value:"income",children:"Income"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),(0,a.jsx)("input",{type:"number",value:z.amount,onChange:e=>W({...z,amount:parseFloat(e.target.value)||0}),className:"input",placeholder:"0.00",step:"0.01"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)("input",{type:"text",value:z.description,onChange:e=>W({...z,description:e.target.value}),className:"input",placeholder:"Enter description"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,a.jsx)("input",{type:"date",value:z.date,onChange:e=>W({...z,date:e.target.value}),className:"input"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[(0,a.jsx)("button",{onClick:()=>T(!1),className:"btn btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{onClick:H,className:"btn btn-primary",children:"Add Entry"})]})]})}),I&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Edit Entry"}),(0,a.jsx)("button",{onClick:()=>{R(!1),$(null)},className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,a.jsxs)("select",{value:z.type,onChange:e=>W({...z,type:e.target.value}),className:"input",children:[(0,a.jsx)("option",{value:"expense",children:"Expense"}),(0,a.jsx)("option",{value:"income",children:"Income"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),(0,a.jsx)("input",{type:"number",value:z.amount,onChange:e=>W({...z,amount:parseFloat(e.target.value)||0}),className:"input",placeholder:"0.00",step:"0.01"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)("input",{type:"text",value:z.description,onChange:e=>W({...z,description:e.target.value}),className:"input",placeholder:"Enter description"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,a.jsx)("input",{type:"date",value:z.date,onChange:e=>W({...z,date:e.target.value}),className:"input"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[(0,a.jsx)("button",{onClick:()=>{R(!1),$(null)},className:"btn btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{onClick:J,className:"btn btn-primary",children:"Update Entry"})]})]})})]},"profit-".concat(s.start))}},9369:function(e,t,s){"use strict";function a(e,t){if(!e||!t)return e||0;switch(t.toLowerCase().trim()){case"weekly":return 4.33*e;case"bi-weekly":case"biweekly":case"bi_weekly":return 2.17*e;default:return e}}function n(e){if(!e)return"monthly";let t=e.match(/Rent cadence:\s*(\w+)/i);return t?t[1]:"monthly"}function r(e,t){if(!e)return"$0";let s=(null==t?void 0:t.toLowerCase().trim())||"monthly";return"$".concat(e.toLocaleString(),"/").concat(s)}function l(e,t,s){let a;let n=new Date(e);switch(s.toLowerCase().trim()){case"weekly":a=new Date(n.getTime()+6048e5*t);break;case"bi-weekly":case"biweekly":case"bi_weekly":a=new Date(n.getTime()+12096e5*t);break;default:(a=new Date(n)).setMonth(a.getMonth()+t)}return a}function c(e,t){if(console.log("calculateTotalLatePayments: Starting calculation for",e.first_name,e.last_name),!e||!t||!e.lease_start_date||!(null==t?void 0:t.monthly_rent))return console.log("calculateTotalLatePayments: Missing required data - tenant:",!!e,"property:",!!t,"lease_start_date:",null==e?void 0:e.lease_start_date,"monthly_rent:",null==t?void 0:t.monthly_rent),{totalLateFees:0,totalOutstanding:0,totalDue:0,latePeriods:0,payPeriods:[]};try{let s=n(t.notes),a=t.monthly_rent;console.log("calculateTotalLatePayments: Cadence:",s,"Monthly rent:",a);let r=a;"weekly"===s?r=a/4.33:("bi-weekly"===s||"biweekly"===s||"bi_weekly"===s)&&(r=a/2.17),console.log("Tenant calculation - Cadence:",s,"Monthly rent:",a,"Period rent:",r);let c=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,a=[],n=new Date,r=0,c=l(e,0,t),i=0,d=3*s;for(;c<=n&&r<2*s&&i<d;)c=l(e,++r,t),i++;if(i>=d)return console.error("getLastExpectedPaymentDates: Safety limit reached, possible infinite loop detected"),[];r=Math.max(0,r-1);for(let c=Math.max(0,r-s+1);c<=r;c++){let s=l(e,c,t);s<=n&&a.push(s)}return a}(e.lease_start_date,s,12),i=0,d=0,o=0,m=c.map(t=>{let a=function(e,t,s,a){let n=function(e){switch(e.toLowerCase().trim()){case"weekly":return 10;case"bi-weekly":case"biweekly":case"bi_weekly":return 20;default:return 45}}(s),r=e.toISOString().split("T")[0];t&&Array.isArray(t)||(t=[]);let l=new Date(e);l.setDate(l.getDate()-2);let c=new Date(e);c.setDate(c.getDate()+5);let i=t.filter(e=>{let t=new Date(e.date);return t>=l&&t<=c&&"completed"===e.status}),d=i.reduce((e,t)=>e+t.amount,0),o=Math.max(0,a-d),m=new Date,x=0===i.length&&m>c;return(x&&console.log("LATE PERIOD:",{expectedDate:r,periodEnd:c.toISOString().split("T")[0],today:m.toISOString().split("T")[0],outstanding:o,lateFee:o>0?n:0}),x)?{isLate:!0,daysLate:Math.max(0,function(e,t){let s=new Date(e);return Math.ceil(Math.abs(new Date(t).getTime()-s.getTime())/864e5)}(c,m)),lateFees:o>0?n:0,totalPaid:d,outstanding:o}:{isLate:!1,daysLate:0,lateFees:0,totalPaid:d,outstanding:o}}(t,e.payment_history,s,r);return a.isLate&&(i+=a.lateFees,d+=a.outstanding,o++),{expectedDate:t,...a}}),x={totalLateFees:i,totalOutstanding:d,totalDue:i+d,latePeriods:o,payPeriods:m};return console.log("calculateTotalLatePayments: Final result for",e.first_name,e.last_name,":",x),x}catch(e){return console.error("Error calculating late payments:",e),{totalLateFees:0,totalOutstanding:0,totalDue:0,latePeriods:0,payPeriods:[]}}}function i(e,t){try{if(!e||!t)return console.log("isTenantLate: Missing tenant or property data"),!1;console.log("isTenantLate: Starting check for tenant",e.first_name,e.last_name),console.log("isTenantLate: Tenant lease_start_date:",e.lease_start_date),console.log("isTenantLate: Property monthly_rent:",t.monthly_rent);let s=c(e,t),a=s.totalDue>0;return console.log("isTenantLate: Result - Total due:",s.totalDue,"Is late:",a),a}catch(e){return console.error("Error checking if tenant is late:",e),!1}}s.d(t,{GN:function(){return a},S6:function(){return n},c1:function(){return c},eP:function(){return r},mq:function(){return i}})}},function(e){e.O(0,[334,134,971,286,293,528,744],function(){return e(e.s=3244)}),_N_E=e.O()}]);