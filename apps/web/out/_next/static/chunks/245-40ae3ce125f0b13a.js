"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[245],{9245:function(e,a,t){t.d(a,{i:function(){return p}});var s=t(7573),l=t(7653),n=t(3351),r=t(8113),o=t(8204),i=t(6286),c=t(269),d=t(6991),m=t(2548);let x=[{value:"weekly",label:"Weekly"},{value:"bi-weekly",label:"Bi-weekly"},{value:"monthly",label:"Monthly"}],u=o.Ry({property_id:o.Z_().optional(),first_name:o.Z_().min(1,"First name is required"),last_name:o.Z_().min(1,"Last name is required"),email:o.Z_().email("Invalid email format").optional().or(o.i0("")),phone:o.Z_().optional().or(o.i0("")),lease_start_date:o.Z_().optional().or(o.i0("")),lease_end_date:o.Z_().optional().or(o.i0("")),rent_cadence:o.Z_().optional().or(o.i0("")),notes:o.Z_().optional().or(o.i0(""))});function p(e){let{tenant:a,onSuccess:t,onCancel:o}=e,[p,h]=(0,l.useState)(!1),[b,j]=(0,l.useState)([]),{register:y,handleSubmit:_,formState:{errors:f},reset:g}=(0,n.cI)({resolver:(0,r.F)(u)});(0,l.useEffect)(()=>{v()},[]),(0,l.useEffect)(()=>{if(a){var e;console.log("TenantForm: Received tenant data:",a),console.log("TenantForm: Leases array:",a.leases);let t=null===(e=a.leases)||void 0===e?void 0:e[0];console.log("TenantForm: Active lease:",t),g({property_id:a.property_id||void 0,first_name:a.first_name,last_name:a.last_name,email:a.email||void 0,phone:a.phone||void 0,lease_start_date:(null==t?void 0:t.lease_start_date)||a.lease_start_date||void 0,lease_end_date:(null==t?void 0:t.lease_end_date)||a.lease_end_date||void 0,notes:a.notes||void 0})}},[a,g]);let v=async()=>{try{let e=await i.PropertiesService.getAll();e.success&&e.data&&j(e.data)}catch(e){console.error("Failed to load properties:",e)}},N=async e=>{console.log("\uD83D\uDD0D FORM SUBMISSION - Data before Zod validation:",e);try{if(h(!0),console.log("Form data (ready for API):",e),a){let s=await i.TenantsService.update(a.id,e);s.success&&s.data?t(s.data):m.ZP.error("Failed to update tenant")}else{console.log("Creating new tenant with data:",e);let a={...e};console.log("CreateTenantData:",a);let s=await i.TenantsService.create(a);console.log("TenantsService.create response:",s),s.success&&s.data?t(s.data):(console.error("Failed to create tenant:",s.error),m.ZP.error("Failed to create tenant: ".concat(s.error||"Unknown error")))}}catch(e){console.error("Error in onSubmit:",e),m.ZP.error("Error saving tenant: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{h(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:a?"Edit Tenant":"Add New Tenant"}),(0,s.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(c.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("form",{onSubmit:_(e=>{console.log("\uD83D\uDD0D FORM SUBMISSION - Data before Zod validation:",e),N(e)},e=>{console.log("\uD83D\uDD0D FORM VALIDATION ERRORS:",e),console.log("\uD83D\uDD0D Form errors object:",e),Object.keys(e).forEach(a=>{console.log("\uD83D\uDD0D ".concat(a," error:"),e[a])})}),className:"p-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),(0,s.jsx)("input",{...y("first_name"),className:"input",placeholder:"Enter first name"}),f.first_name&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:f.first_name.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),(0,s.jsx)("input",{...y("last_name"),className:"input",placeholder:"Enter last name"}),f.last_name&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:f.last_name.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,s.jsx)("input",{...y("email"),type:"email",className:"input",placeholder:"Enter email address"}),f.email&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:f.email.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),(0,s.jsx)("input",{...y("phone"),type:"tel",className:"input",placeholder:"Enter phone number"}),f.phone&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:f.phone.message})]}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 mt-6",children:"Property Assignment"})}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign to Property (Optional)"}),(0,s.jsxs)("select",{...y("property_id"),className:"input",children:[(0,s.jsx)("option",{value:"",children:"Select a property (optional)"}),b.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," - ",e.address]},e.id))]})]}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 mt-6",children:"Lease Information"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lease Start Date"}),(0,s.jsx)("input",{...y("lease_start_date"),type:"date",className:"input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lease End Date"}),(0,s.jsx)("input",{...y("lease_end_date"),type:"date",className:"input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"rent_cadence",className:"block text-sm font-medium text-gray-700 mb-2",children:"Rent Cadence"}),(0,s.jsxs)("select",{...y("rent_cadence"),className:"input",children:[(0,s.jsx)("option",{value:"",children:"Select rent cadence"}),x.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))]}),f.rent_cadence&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:f.rent_cadence.message})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),(0,s.jsx)("textarea",{...y("notes"),rows:3,className:"input",placeholder:"Enter any additional notes"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-8",children:[!a&&(0,s.jsx)("button",{type:"button",onClick:async()=>{try{console.log("Testing minimal tenant creation...");let e={first_name:"Test",last_name:"User",email:"test@example.com"};console.log("Test data:",e);let a=await i.TenantsService.create(e);console.log("Test response:",a),a.success?m.ZP.success("Test tenant created successfully!"):m.ZP.error("Test failed: ".concat(a.error))}catch(e){console.error("Test error:",e),m.ZP.error("Test error: ".concat(e))}},className:"btn btn-secondary mr-auto",children:"\uD83E\uDDEA Test Minimal Tenant"}),(0,s.jsx)("button",{type:"button",onClick:o,className:"btn btn-secondary",disabled:p,children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),a?"Update Tenant":"Create Tenant"]})})]})]})]})})}}}]);